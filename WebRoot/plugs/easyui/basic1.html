<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Basic DataGrid - jQuery EasyUI Demo</title>
	<link rel="stylesheet" type="text/css" href="themes/default/easyui.css">
	<link rel="stylesheet" type="text/css" href="themes/icon.css">
	<script type="text/javascript" src="../jquery/1.10.2/jquery.min.js"></script>
	<script type="text/javascript" src="1.3.6/jquery.easyui.min.js"></script>	
</head>
<body>
	<h2 onClick="evenTest()">Basic DataGrid</h2>
	<p>The DataGrid is created from markup, no JavaScript code needed.</p>
	<div style="margin:20px 0;"></div>


<table id="dg" class="easyui-datagrid" style="width:800px;height:auto;" data-options="
				iconCls: 'icon-edit',
				onClickCell: onClickCell">
	<thead data-options="frozen:true">
		<tr>
			<th field="name1" width="150">Col 1</th>
		</tr>
	</thead>
	<thead>
		<tr>
			<th data-options="field:'name2',width:80,align:'right',editor:'text'">Col 2</th>
			<th field="name3" width="150">Col 3</th>
			<th field="name4" width="150">Col 4</th>
			<th field="name5" width="150">Col 5</th>
			<th field="name6" width="150">Col 6</th>
		</tr>                          
	</thead>                           
	<tbody>
		<tr>                           
			<td>Data 1</td>
			<td id="age" eletype="text" elename="age">Data 3332</td>            
			<td>测试</td>
			<td><span title='www这里'>这里是表格title</span></td>            
			<td>Data 5</td>            
			<td>Data 6</td>            
		</tr>                          
		<tr>                           
			<td>Data 1</td>            
			<td id="pz" eletype="text" elename="pz">期中</td>            
			<td>Data 3</td>            
			<td>Data 4</td>            
			<td>Data 5</td>            
			<td>Data 6</td>            
		</tr>                          
		<tr>                           
			<td>Data 1</td>            
			<td>Data 2</td>            
			<td>Data 3</td>            
			<td>Data 4</td>            
			<td>Data 5</td>            
			<td>Data 6</td>            
		</tr>                          
		<tr>                           
			<td>Data 1</td> 
			<td>Data 2</td>            
			<td>Data 3</td>            
			<td>Data 4</td>            
			<td>Data 5</td>            
			<td>Data 6</td>            
		</tr>                          
		<tr>                           
			<td>Data 1</td> 
			<td>Data 2</td>            
			<td>Data 3</td>            
			<td>Data 4</td>            
			<td>Data 5</td>            
			<td>Data 6</td>            
		</tr>                          
		<tr>                           
			<td>Data 1</td> 
			<td>Data 2</td>            
			<td>Data 3</td>            
			<td>Data 4</td>            
			<td title="333">Data 5333</td>            
			<td>Data 6</td>            
		</tr>                          
		<tr>                           
			<td>Data 1</td> 
			<td>Data 2</td>            
			<td>Data 3</td>            
			<td>Data 4</td>            
			<td>Data 5</td>            
			<td>Data 6</td>            
		</tr>                          
		<tr>                           
			<td>Data 1</td> 
			<td>Data 2</td>            
			<td>Data 3</td>            
			<td>Data 4</td>            
			<td>Data 5</td>            
			<td>Data 6</td>            
		</tr>                          
		<tr>                           
			<td>Data 1</td> 
			<td>Data 2</td>            
			<td>Data 3</td>            
			<td>Data 4</td>            
			<td>Data 5</td>            
			<td>Data 6</td>            
		</tr>                          
		<tr>                           
			<td>Data 1</td> 
			<td>Data 2</td>            
			<td>Data 3</td>            
			<td>Data 4</td>            
			<td>Data 5</td>            
			<td>Data 6</td>            
		</tr>                          
		<tr>                           
			<td>Data 1</td> 
			<td>Data 2</td>            
			<td>Data 3</td>            
			<td>Data 4</td>            
			<td>Data 5</td>            
			<td>Data 6</td>            
		</tr>                          
		<tr>                           
			<td>Data 1</td> 
			<td>Data 2</td>            
			<td>Data 3</td>            
			<td>Data 4</td>            
			<td>Data 5</td>            
			<td>Data 6</td>            
		</tr>                          
		<tr>                           
			<td>Data 1</td> 
			<td>Data 2</td>            
			<td>Data 3</td>            
			<td>Data 4</td>            
			<td>Data 5</td>            
			<td>Data 6</td>            
		</tr>                          
	</tbody>                           
</table>

</body>
	<script type="text/javascript">
		$.extend($.fn.datagrid.methods, {
			editCell: function(jq,param){
				return jq.each(function(){
					var opts = $(this).datagrid('options');
					var fields = $(this).datagrid('getColumnFields',true).concat($(this).datagrid('getColumnFields'));
					for(var i=0; i<fields.length; i++){
						var col = $(this).datagrid('getColumnOption', fields[i]);
						col.editor1 = col.editor;
						if (fields[i] != param.field){
							col.editor = null;
						}
					}
					$(this).datagrid('beginEdit', param.index);
					for(var i=0; i<fields.length; i++){
						var col = $(this).datagrid('getColumnOption', fields[i]);
						col.editor = col.editor1;
					}
				});
			}
		});
		
		var editIndex = undefined;
		function endEditing(){
			if (editIndex == undefined){return true}
			if ($('#dg').datagrid('validateRow', editIndex)){
				$('#dg').datagrid('endEdit', editIndex);
				editIndex = undefined;
				return true;
			} else {
				return false;
			}
		}
		function onClickCell(index, field){
			if (endEditing()){
				$('#dg').datagrid('selectRow', index).datagrid('editCell', {index:index,field:field});
				editIndex = index;
			}
		}


		function evenTest(){
			var rObj = new Array();
			var eleid = "";//jsp页面的元素ID号(必须显现的写出)
			var eletype = "";
			$("body [id]").each(function(){//这里是用jquery查找页面上所有包括ID的元素
				eleid = $(this).attr("id");
				eletype = $(this).attr("eletype");
				var o = new Object();
				o.name = $(this).attr("elename");//这里取的是字段名
				//alert("195============="+o.name+"=="+eleid+"====="+$(this).val());
				rObj.push(o);//收集选中项
			});
			return rObj;
		}
	</script>
</html>